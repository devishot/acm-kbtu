<%= render "contests/contest" %>

<div style="background-color: white;">
  <ul class="nav nav-tabs" id="body-bgcolor">
    <% for i in 1..@contest.problems_count %>
      <% next if @contest.problems[i].disabled == true %>
      <li <%= "class=active" if !@submit.nil? && @submit.problem.order == i %> >
        <%= link_to "#{@contest.problems[i].order_abc}", "/contests/#{@contest.path}/#{i}" %>
      </li>
    <% end %>
  </ul>

  <% if @submit.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@submit.errors.count, "error") %> prohibited this submit from being saved:</h2>
      <ul>
      <% @submit.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>


  <div id="articles">
    <% if can? :edit, @submit.problem %>
      <div class="btn-group" style="right: 0%; float: right; position: relative;" >
        <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
          <i class="icon-pencil icon-white"></i> Edit
          <span class="caret"></span>
        </a>
        <!-- dropdown menu links -->
        <ul class="dropdown-menu">
          <%= link_to 'Edit Problem'.html_safe,
            contest_problem_path(@contest.path, @submit.problem.order)+'/edit'%>

          <%= link_to 'Edit Statement'.html_safe,
              contest_problem_path(@contest.path, @submit.problem.order)+'/edit_statement'%>
        </ul>            
      </div>
    <% end %>

    <center>
      <h3>
        <%= @submit.problem.statement['title'] %>
      </h3>

      <% if not @problem.statement["file_link"].blank? %>
        <%= link_to '<i class="icon-download-alt"></i> Statement'.html_safe, 
              contest_problem_path(@contest.path, @problem.order)+'/statement', 
              :class => 'btn' %>
        <br />
        <br />        
      <% end %>

      <table class="table table-bordered"  style="width: 440px;">
        <tr>
          <td style="width: 100px;">Time limit:</td>
          <td style="width: 120px; text-align:center"><%= @submit.problem.time_limit %> s </td>

          <td style="width: 100px;">Input file:</td>
          <td style="width: 120px; text-align:center"><%= (@submit.problem.input_file.blank?) ? 'standart input' : @submit.problem.input_file %> </td>
        </tr>

        <tr>
          <td>Memory limit:</td>
          <td style="text-align:center"><%= @submit.problem.memory_limit %> Mb </td>

          <td>Output file:</td>
          <td style="text-align:center"><%= (@submit.problem.output_file.blank?) ? 'standart output' : @submit.problem.output_file %> </td>
        </tr>
      </table>

    </center>

    <% if not @problem.statement["text"].blank? %>
      <%= render 'statement' %>
      <br />
      <br />
    <% end %>


    <% #if NOT author and admin then he can send submit %>
    <% if !(current_user == @contest.user || current_user.admin?) %>
      <% if not @contest.over? %>
        <%= form_tag(send_submit_path, :method => :post, :multipart => true) do %>
          <%= hidden_field_tag :problem , @submit.problem_id %>
          <%= hidden_field_tag :participant, @submit.participant_id %>
          <%= file_field_tag   :file %>
          <div class="actions">
            <%= submit_tag "Submit" %>
          </div>
          <br />
        <% end %>
      <% end %>

      <%= render "submits/submits" %>
    <% end %>
    <br />

  </div>
</div>
<br />